# Tender - 标书智能体对话工具

## 核心理念
**一个命令，智能对话，完成所有标书工作** - 通过自然语言对话完成标书的全流程生成和管理

## 使用方式

### 唯一命令
```bash
tender
```

启动后进入智能对话模式，通过自然语言完成所有操作。

## 核心功能

### 智能对话引擎
- **自然语言理解**: 理解用户的标书需求和指令
- **智能任务规划**: 自动分解复杂任务，制定执行计划
- **上下文记忆**: 记住项目状态和历史对话
- **智能建议**: 主动提供专业建议和下一步操作
- **多轮对话**: 支持复杂任务的分步完成
- **自适应调整**: 根据进展动态调整任务计划

### 内置 MCP 工具集

#### 文件操作工具
```python
- read_file(path)                    # 读取文件内容
- write_file(path, content)          # 写入文件
- list_files(directory)              # 列出目录文件
- create_directory(path)             # 创建目录
- delete_file(path)                  # 删除文件
- read_subsection_file(section, subsection) # 读取三级标题内容文件
- write_subsection_file(section, subsection, content) # 写入三级标题内容
- list_subsection_files(section)     # 列出章节下所有三级标题文件
- get_section_structure()            # 获取完整的章节结构
```

#### 招标文件处理工具
```python
- extract_pdf_content(file_path)      # 提取PDF文本内容
- parse_tender_requirements(content)   # 解析招标要求
- extract_key_info(content)           # 提取关键信息
- analyze_scoring_criteria(content)    # 分析评分标准
- detect_tender_type(content)         # 识别招标类型
```

#### 大纲生成工具
```python
- generate_outline(requirements, type) # 生成标书大纲
- validate_outline(outline)           # 验证大纲完整性
- suggest_improvements(outline)       # 建议大纲优化
- expand_section(section_title)       # 展开章节详情
```

#### 内容生成工具
```python
- generate_subsection_content(section, subsection, requirements) # 生成三级标题内容
- parallel_generate_subsections(subsections_list) # 多线程并行生成所有三级内容
- generate_section_outline(section_title)       # 生成章节的三级标题大纲
- refine_subsection_content(section, subsection, instructions) # 优化三级标题内容
- generate_technical_solution(requirements)     # 生成技术方案
- create_project_timeline(requirements)         # 创建项目时间表
- generate_budget_breakdown(amount, items)      # 生成预算分解
- batch_update_subsections(updates_dict)        # 批量更新多个三级标题
```

#### 文档处理工具
```python
- convert_to_docx(markdown_content)   # 转换为Word文档
- one_click_docx_export()            # 一键导出完整Word标书
- merge_subsections_to_docx()        # 合并所有三级标题内容为Word
- assemble_section_from_subsections(section) # 组装章节从三级标题文件
- apply_template(content, template)   # 应用文档模板
- format_tables(data)                 # 格式化表格
- insert_charts(data, chart_type)     # 插入图表
- export_pdf(docx_path)              # 导出PDF
- batch_format_docx(subsections)     # 批量格式化三级标题内容
```

#### 项目管理工具
```python
- create_project(name)               # 创建项目
- save_project_state(state)          # 保存项目状态
- load_project_state(project_name)   # 加载项目状态
- backup_project(project_name)       # 备份项目
- list_projects()                    # 列出所有项目
```

#### 智能任务规划工具
```python
- analyze_user_intent(message)       # 分析用户意图和需求
- create_task_plan(intent, context)  # 创建详细任务执行计划
- decompose_complex_task(task)       # 分解复杂任务为子任务
- estimate_task_time(task_list)      # 估算任务执行时间
- prioritize_tasks(tasks)            # 任务优先级排序
- track_task_progress(task_id)       # 跟踪任务执行进度
- adjust_plan_dynamically(progress)  # 根据进展动态调整计划
- suggest_next_actions(current_state) # 建议下一步行动
```

## 内置提示词库

### 系统提示词
```
你是一个专业的标书智能体助手，具备以下能力：
1. 深度理解招标文件内容和要求
2. 生成符合招标要求的专业标书
3. 提供标书写作的专业建议
4. 协助完成标书的全流程管理

请始终保持专业、准确、高效的工作风格。
```

### 功能提示词模板

#### 招标文件分析
```
分析以下招标文件，提取关键信息：
- 招标单位和项目名称
- 项目预算和周期
- 技术要求和标准
- 评分标准和权重
- 投标截止时间
- 特殊要求和注意事项

招标文件内容：{content}
```

#### 大纲生成
```
根据以下招标要求生成专业标书大纲：

招标要求：{requirements}
项目类型：{project_type}
预算范围：{budget}

请生成包含以下标准章节的大纲：
1. 公司介绍和资质
2. 项目理解和需求分析
3. 技术方案和实施计划
4. 项目管理和质量保证
5. 预算报价和成本分析
6. 售后服务和支持方案
```

#### 内容生成
```
为标书章节"{section_title}"生成专业内容：

章节要求：{section_requirements}
项目背景：{project_context}
技术要求：{technical_requirements}

请确保内容：
- 符合招标要求
- 突出技术优势
- 体现专业水准
- 逻辑清晰完整
```

#### 内容优化
```
请优化以下标书内容：

原始内容：{original_content}
优化要求：{optimization_requirements}

优化方向：
- 提高专业性和说服力
- 增强逻辑性和条理性
- 突出竞争优势
- 符合评分标准
```

#### 一键Word导出
```
将当前标书项目一键导出为专业Word文档：

项目信息：{project_info}
章节列表：{sections_list}
格式要求：{format_requirements}

导出配置：
- 使用标准标书模板
- 自动生成目录和页码
- 统一字体和格式
- 插入公司Logo和签章位置
- 生成封面和声明页
- 优化表格和图表显示
```

#### 智能任务规划
```
根据用户需求自动制定标书制作计划：

用户输入：{user_message}
项目背景：{project_context}
当前状态：{current_state}

规划要素：
- 任务分解：将复杂需求拆分为具体可执行的子任务
- 优先级排序：根据重要性和依赖关系排序
- 时间估算：预估每个任务的执行时间
- 资源分配：合理分配AI处理资源
- 里程碑设置：设定关键检查点
- 风险识别：预判可能的问题和解决方案

输出格式：
1. 📋 任务概览 (总体目标和范围)
2. 🎯 执行计划 (分步骤详细计划)  
3. ⏰ 时间安排 (预估完成时间)
4. 💡 建议优化 (提升效率的建议)
```

## 对话示例

### 项目启动
```
$ tender

🎯 Tender AI - 标书智能体助手 v1.0.0

👋 你好！我是你的标书智能助手，可以帮你完成标书的全流程工作。

💡 你可以：
• 上传招标文件让我分析
• 创建新的标书项目
• 继续之前的项目工作
• 询问标书相关问题

请告诉我你想做什么？

 > 我有一个智慧城市项目的招标文件，帮我分析一下并制作标书

🤖 **智能任务规划启动**

📋 **任务概览**
目标：分析智慧城市招标文件并制作完整标书
范围：从文件分析到最终Word文档输出
预估工作量：中等复杂度项目

🎯 **自动执行计划**
1️⃣ **文件分析阶段** (预估3-5分钟)
   • 提取PDF招标文件内容
   • 解析关键信息和要求  
   • 分析评分标准和权重
   • 识别技术难点和机会

2️⃣ **项目准备阶段** (预估1-2分钟)
   • 创建项目目录结构
   • 生成标书大纲框架
   • 设置章节模板

3️⃣ **内容生成阶段** (预估8-12分钟)
   • 并行生成各三级标题内容
   • 重点优化技术方案章节
   • 定制化公司介绍内容

4️⃣ **质量优化阶段** (预估3-5分钟)  
   • 整体内容审查
   • 格式统一和美化
   • 导出专业Word文档

⏰ **总预估时间**: 15-24分钟
💡 **优化建议**: 准备好公司资质材料以便快速定制

🚀 **开始执行计划？** 请提供招标文件路径，我将按计划自动完成所有步骤。

> ./documents/智慧城市招标文件.pdf

🔍 **[1/4] 文件分析阶段** - 正在执行...
✅ 分析完成！

📋 **项目概况**
• 项目名称：某市智慧城市综合管理平台建设
• 招标单位：某市政府信息化办公室  
• 预算范围：800-1200万元
• 项目周期：18个月
• 投标截止：2024年3月15日

🎯 **关键要求**
• 需要建设统一的城市数据平台
• 要求支持10万+并发用户
• 必须通过等保三级认证
• 需要7*24小时运维服务

📊 **评分标准**
• 技术方案 (40分)
• 公司资质 (20分) 
• 项目经验 (20分)
• 报价合理性 (20分)

💡 **自动进入下一阶段** - 无需手动确认，按计划继续执行

🚀 **[2/4] 项目准备阶段** - 正在执行...
✅ 项目"智慧城市综合管理平台"创建完成！
✅ 目录结构初始化完成！

📝 **[2/4] 生成标书大纲** - 正在执行...
✅ 大纲生成完成，包含8个主要章节：

1. 公司介绍及资质证明
2. 项目需求理解与分析  
3. 总体技术方案设计
4. 系统架构与技术选型
5. 项目实施计划与管理
6. 质量保证与风险控制
7. 运维服务与技术支持
8. 项目预算与报价分析

🤔 **智能评估**: 大纲结构合理，符合招标要求，自动进入内容生成阶段

⚡ **[3/4] 内容生成阶段** - 启动多线程并行生成各三级标题内容...

🔄 **并行生成进度** (24个线程同时工作，精细化内容生成)

**第1章：公司介绍及资质证明**
✅ 1.1-公司基本情况.md - 完成 (1.2s)
✅ 1.2-资质证书.md - 完成 (0.8s)
✅ 1.3-技术团队介绍.md - 完成 (1.5s)

**第2章：项目需求理解与分析**  
✅ 2.1-招标需求分析.md - 完成 (1.8s)
✅ 2.2-技术难点识别.md - 完成 (1.4s)
⏳ 2.3-解决方案概述.md - 生成中... (65%)

**第3章：总体技术方案设计**
✅ 3.1-方案概述.md - 完成 (2.1s)
⏳ 3.2-核心技术架构.md - 生成中... (45%)
⏳ 3.3-技术选型说明.md - 生成中... (32%)
⏳ 3.4-安全保障体系.md - 生成中... (18%)

**第4章：系统架构与技术选型**
⏳ 4.1-系统总体架构.md - 生成中... (28%)
⏳ 4.2-数据库设计.md - 生成中... (15%)
⏳ 4.3-接口设计.md - 生成中... (8%)
...

📁 **精细化文件结构**
```
./sections/
├── 01-公司介绍及资质证明/
│   ├── 1.1-公司基本情况.md      ✅ 已完成
│   ├── 1.2-资质证书.md          ✅ 已完成
│   └── 1.3-技术团队介绍.md      ✅ 已完成
├── 02-项目需求理解与分析/
│   ├── 2.1-招标需求分析.md      ✅ 已完成
│   ├── 2.2-技术难点识别.md      ✅ 已完成
│   └── 2.3-解决方案概述.md      ⏳ 生成中
├── 03-总体技术方案设计/
│   ├── 3.1-方案概述.md          ✅ 已完成
│   ├── 3.2-核心技术架构.md      ⏳ 生成中
│   ├── 3.3-技术选型说明.md      ⏳ 生成中
│   └── 3.4-安全保障体系.md      ⏳ 生成中
└── ...
```

💡 **精细化管理优势**
• 每个三级标题独立文件，粒度更细
• 可精确编辑任意小节内容
• 多线程并行生成，效率更高
• 便于团队协作和版本控制
• 支持模块化复用和组合

🛠️ **生成过程中，你可以随时**：
• 查看具体小节：输入"查看3.2核心技术架构"
• 编辑特定内容：输入"编辑1.1公司基本情况"
• 优化某个小节：输入"优化3.3技术选型"
• 查看章节结构：输入"显示第3章结构"

 > 查看第3章

📖 **显示第3章结构和内容**

📁 **第3章：总体技术方案设计**
```
./sections/03-总体技术方案设计/
├── 3.1-方案概述.md          ✅ 已完成 (1.2KB, 约500字)
├── 3.2-核心技术架构.md      ✅ 已完成 (2.8KB, 约1,100字)  
├── 3.3-技术选型说明.md      ✅ 已完成 (3.1KB, 约1,200字)
└── 3.4-安全保障体系.md      ✅ 已完成 (1.9KB, 约750字)
```

📄 **3.1 方案概述** (3.1-方案概述.md)
```markdown
基于微服务架构和云原生技术，构建高可用、高并发、高安全的智慧城市综合管理平台。
方案采用分层设计理念，确保系统的可扩展性、可维护性和安全性...
```

📄 **3.2 核心技术架构** (3.2-核心技术架构.md)  
```markdown
采用"云-边-端"三层架构设计：

### 云端层
- 统一数据中心和计算资源
- 核心业务逻辑处理
- 数据存储和分析

### 边缘层  
- 分布式边缘计算节点
- 实时数据处理
- 本地缓存和预处理

### 终端层
- 多样化接入设备
- 数据采集和展示
- 用户交互界面
```

💭 **你可以**：
• 查看具体小节：输入"打开3.2核心技术架构"
• 编辑特定内容：输入"编辑3.1方案概述"  
• 优化某个小节：输入"优化3.3技术选型"
• 添加新的小节：输入"添加3.5性能优化方案"

> 技术架构部分需要更详细，增加一些具体的技术选型说明

🔧 正在优化技术架构相关内容...

📝 **更新文件**: 
• 3.2-核心技术架构.md (主要更新)
• 3.3-技术选型说明.md (补充详细信息)

✅ **优化完成！已增加**：
• 详细的微服务技术栈说明
• 数据库选型和分布式方案  
• 消息队列和缓存架构
• 安全防护技术方案

📁 **文件更新信息**
• 3.2-核心技术架构.md: 2.8KB → 4.2KB (+1,400字)
• 3.3-技术选型说明.md: 3.1KB → 5.8KB (+2,700字)
• 新增技术选型对比表格：4个
• 新增架构图说明：3处
• 新增性能指标说明：多项

📄 **精细化更新优势**：
• 只更新相关的小节文件，不影响其他内容
• 可以精确控制每个小节的内容质量
• 便于后续单独优化和维护
• 支持并行编辑不同小节

💡 你可以：
• 查看更新后的内容：输入"打开3.2核心技术架构"
• 继续优化其他小节：输入"优化3.4安全保障"
• 添加新的技术小节：输入"添加3.5性能优化"

> 继续

⚡ **[3/4] 继续生成剩余章节**...
✅ **所有三级标题内容生成完成！**

📊 **阶段3完成状态**
• 生成文件数：24个三级标题文件
• 总字数统计：约2.8万字
• 图表标记：12处
• 技术方案：详细完整
• 完成度：100%

🔍 **[4/4] 质量优化阶段** - 自动启动...

🤖 **智能决策**: 根据计划自动进行整体审查和Word导出

📄 **自动导出Word文档** - 按计划执行最后步骤...

📄 正在一键导出Word文档...

🔧 **格式化处理中**
✅ 应用标准标书模板
✅ 生成封面和目录
✅ 统一字体格式 (标题：黑体，正文：宋体)
✅ 插入页眉页脚和页码
✅ 优化表格和图表显示
✅ 添加公司Logo位置标记

📄 **导出完成！**

📁 **文件信息**
• 保存位置：./projects/智慧城市综合管理平台/output/标书_v1.0.docx
• 文件大小：2.3MB
• 总页数：45页
• 包含图表：12个
• 格式：标准标书模板

📋 **文档结构**
• 封面页 (公司信息+项目标题)
• 目录页 (自动生成)
• 正文内容 (8个主要章节)
• 附件页 (资质证明位置)

💡 **下一步建议**
• 添加公司Logo到封面
• 检查并完善资质附件
• 最终审查后可直接提交

🎉 **任务计划完美执行完成！**

📋 **执行总结**
✅ 文件分析阶段 - 3分钟 (按时完成)
✅ 项目准备阶段 - 1分钟 (提前完成)  
✅ 内容生成阶段 - 9分钟 (高效完成)
✅ 质量优化阶段 - 4分钟 (按时完成)

⏰ **总耗时**: 17分钟 (在预估范围内)
🎯 **完成度**: 100% (所有计划任务已完成)

💡 **智能建议**: 
• 标书已可直接提交，质量达到专业水准
• 建议添加公司Logo到封面提升视觉效果
• 可根据需要微调个别技术细节

🤖 **下次优化**: 我已学习了这次的执行模式，下次类似任务将更加高效！

还有其他需要我帮助的吗？
```

## 技术实现

### 核心架构
```python
class TenderAI:
    def __init__(self):
        self.mcp_server = MCPServer()
        self.conversation = ConversationManager()
        self.project_manager = ProjectManager()
        self.prompt_library = PromptLibrary()
    
    def start_chat(self):
        """启动对话模式"""
        while True:
            user_input = input("> ")
            response = self.process_message(user_input)
            print(response)
    
    def process_message(self, message):
        """处理用户消息"""
        intent = self.understand_intent(message)
        return self.execute_intent(intent, message)
```

### MCP 服务器集成
```python
# mcp_tools.py
@mcp_tool
def extract_pdf_content(file_path: str) -> str:
    """提取PDF文件内容"""
    # 实现PDF内容提取
    pass

@mcp_tool  
def generate_outline(requirements: str, project_type: str) -> dict:
    """生成标书大纲"""
    # 实现大纲生成逻辑
    pass

@mcp_tool
def generate_section_content(title: str, context: str) -> str:
    """生成章节内容"""
    # 实现内容生成逻辑
    pass

@mcp_tool
def parallel_generate_subsections(subsections_list: list) -> dict:
    """多线程并行生成所有三级标题内容"""
    # 实现多线程并行生成逻辑
    # 每个三级标题生成独立的markdown文件
    # 支持24+线程同时工作，精细化内容生成
    pass

@mcp_tool
def one_click_docx_export(project_path: str) -> dict:
    """一键导出专业Word标书文档"""
    # 合并所有章节markdown文件
    # 应用模板并导出Word文档
    pass
```

## 安装和使用

### 安装
```bash
pip install tender-ai
```

### 启动
```bash
tender
```

### 配置
首次使用时会引导配置 API 密钥和基本设置。

## 一键Word导出功能详解

### 核心特性
- **智能模板**: 自动应用标准标书格式模板
- **完整结构**: 自动生成封面、目录、正文、附件页
- **专业格式**: 统一字体、间距、页眉页脚设置
- **图表优化**: 自动调整表格和图表的显示效果
- **批量处理**: 一次性处理所有章节内容

### 导出流程
1. **文件扫描**: 自动扫描sections目录下的所有markdown文件
2. **内容合并**: 按序号顺序合并所有章节markdown内容
3. **模板应用**: 应用标准标书Word模板
4. **格式统一**: 自动调整字体、段落、页面设置
5. **结构生成**: 创建封面、目录、页码等
6. **质量检查**: 验证格式完整性和一致性
7. **文件输出**: 生成最终的专业Word文档

### 精细化文件管理
- **目录结构**: 每章一个目录，如 `01-公司介绍及资质证明/`
- **文件命名**: 三级标题文件 `1.1-公司基本情况.md`, `1.2-资质证书.md` 等
- **独立编辑**: 每个三级标题内容可单独编辑，粒度更细
- **模块化复用**: 小节内容可在不同项目间复用
- **版本控制**: Git友好，每个小节变更独立跟踪
- **并行处理**: 多个三级标题可同时生成和修改
- **智能组装**: 自动按章节结构组装完整文档

### 快速命令
用户只需说：
- "导出Word" 
- "生成Word文档"
- "一键导出"
- "转换成Word"

系统自动完成所有格式化和导出工作。

## 设计优势

1. **极简使用**: 只需一个命令，所有操作通过对话完成
2. **智能规划**: 自动分析需求，制定详细执行计划
3. **自主执行**: 按计划自动完成复杂任务，无需人工干预
4. **专业能力**: 内置丰富的标书专业知识和模板
5. **高效协作**: AI 主动建议，人机协作完成复杂任务
6. **状态保持**: 记住项目进度，支持随时中断和继续
7. **一键导出**: 专业Word文档一键生成，格式完美
8. **学习优化**: 从每次执行中学习，持续优化工作流程

## 智能任务规划特色

### 🤖 **自动任务分解**
- 将"制作标书"自动分解为4个阶段、20+个子任务
- 根据招标文件复杂度智能调整任务粒度
- 识别任务依赖关系，优化执行顺序

### ⏰ **精准时间预估**
- 基于历史数据预估每个任务耗时
- 动态调整预估时间，提高准确性
- 提供总体时间规划，便于用户安排

### 🎯 **智能决策能力**
- 自动评估大纲质量，决定是否需要调整
- 根据内容生成情况智能安排优化重点
- 无需用户确认即可执行标准化流程

### 📊 **实时进度跟踪**
- 清晰显示当前执行阶段和进度
- 提供详细的任务完成状态
- 实时调整后续任务安排

这种设计让标书制作从"对话协作"升级为"智能自动化"，用户只需提出需求，AI就能自主完成全流程工作！

